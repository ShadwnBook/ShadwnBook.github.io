<!DOCTYPE html>
<html lang="zh-tw" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="影片自動套框功能開發#import osimport subprocessimport cv2import numpy as np# 設定影片和圖片框的資料夾路徑videos_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;frames_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;output_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;# 取得影片和圖片框的清單for video_file in os.listdir(videos_folder):if video_file.endswith(&#39;.mp4&#39;):video_name = os.path.splitext(video_file)[0]video_path = os.path.join(videos_folder, video_file)# 取得圖片框的寬度和高度for frame_file in os.listdir(frames_folder):if frame_file.endswith(&#39;.png&#39;):frame_name = os.path.splitext(frame_file)[0]frame_path = os.path.join(frames_folder, frame_file)video_output = os.path.join(output_folder, f&#39;{video_name}_{frame_name }.mp4&#39;)# 讀取圖片image = cv2.imread(frame_path , cv2.IMREAD_UNCHANGED)# 提取Alpha通道alpha_channel = image[:, :, 3]# 找到alpha值為0的像素的位置indices = np.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="" />
<meta property="og:description" content="影片自動套框功能開發#import osimport subprocessimport cv2import numpy as np# 設定影片和圖片框的資料夾路徑videos_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;frames_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;output_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;# 取得影片和圖片框的清單for video_file in os.listdir(videos_folder):if video_file.endswith(&#39;.mp4&#39;):video_name = os.path.splitext(video_file)[0]video_path = os.path.join(videos_folder, video_file)# 取得圖片框的寬度和高度for frame_file in os.listdir(frames_folder):if frame_file.endswith(&#39;.png&#39;):frame_name = os.path.splitext(frame_file)[0]frame_path = os.path.join(frames_folder, frame_file)video_output = os.path.join(output_folder, f&#39;{video_name}_{frame_name }.mp4&#39;)# 讀取圖片image = cv2.imread(frame_path , cv2.IMREAD_UNCHANGED)# 提取Alpha通道alpha_channel = image[:, :, 3]# 找到alpha值為0的像素的位置indices = np." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ShadwnBook.github.io/docs/%E4%BD%9C%E5%93%81/%E5%BD%B1%E7%89%87%E8%87%AA%E5%8B%95%E5%A5%97%E6%A1%86/" /><meta property="article:section" content="docs" />


<title>影片自動套框 | Shadwn Blog</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="stylesheet" href="/book.min.4f0117e74e5337280f18eb9641eae520cb4b25adcf5dd64fafad4664145a5957.css" integrity="sha256-TwEX505TNygPGOuWQerlIMtLJa3PXdZPr61GZBRaWVc=" crossorigin="anonymous"><!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Shadwn Blog</span>
  </a>
</h2>













  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>文章</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E7%B5%90%E6%A7%8B%E4%B8%BB%E7%BE%A9/" class="">結構主義</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E9%A6%AC%E5%85%8B%E6%80%9D%E4%B8%BB%E7%BE%A9/" class="">馬克思主義</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E9%9F%93%E7%82%B3%E5%93%B2%E5%B0%88%E9%A1%8C/" class="">韓炳哲專題</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E9%9F%93%E7%82%B3%E5%93%B2%E5%B0%88%E9%A1%8C/%E5%80%A6%E6%80%A0%E7%A4%BE%E6%9C%83/" class="">韓炳哲 關鍵三部曲：《倦怠社會》</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E6%B3%A2%E8%B5%AB%E5%A3%AB%E5%B0%88%E9%A1%8C/" class="">波赫士專題</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E6%B3%A2%E8%B5%AB%E5%A3%AB%E5%B0%88%E9%A1%8C/%E6%B3%A2%E8%B5%AB%E5%A3%AB%E5%90%8D%E7%AF%87/" class="">【推薦】波赫士名篇</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E6%B3%A2%E8%B5%AB%E5%A3%AB%E5%B0%88%E9%A1%8C/%E6%B3%A2%E8%B5%AB%E5%A3%AB_%E7%A6%AE%E7%89%A9/" class="">波赫士《禮物》</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E6%B3%A2%E8%B5%AB%E5%A3%AB%E5%B0%88%E9%A1%8C/%E6%B3%A2%E8%B5%AB%E5%A3%AB_%E5%8F%A6%E4%B8%80%E5%80%8B%E4%BA%BA%E8%A9%B3%E8%A7%A3/" class="">波赫士:另一個人詳解</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E6%9D%9C%E6%96%AF%E5%A6%A5%E4%B9%9F%E5%A4%AB%E6%96%AF%E5%9F%BA%E5%B0%88%E9%A1%8C/" class="">杜斯妥也夫斯基專題</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E6%9D%9C%E6%96%AF%E5%A6%A5%E4%B9%9F%E5%A4%AB%E6%96%AF%E5%9F%BA%E5%B0%88%E9%A1%8C/%E5%8D%A1%E6%8B%89%E9%A6%AC%E5%8A%A9%E5%A4%AB%E5%85%84%E5%BC%9F%E5%80%91-major-/" class="">讀 : 卡拉馬助夫兄弟們 ( Major )</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E5%8A%87%E5%A0%B4%E5%8A%87%E6%9C%AC%E6%A0%BC%E5%BC%8F/" class="">劇場劇本格式</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E5%8D%A1%E7%88%BE%E7%B6%AD%E8%AB%BE%E8%AA%95%E8%BE%B0100%E5%91%A8%E5%B9%B4/" class="">卡爾維諾誕辰100周年</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E5%BF%83%E7%90%86%E7%AD%86%E8%A8%98/" class="">心理筆記</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E6%98%86%E5%BE%B7%E6%8B%89%E7%AD%86%E8%A8%98/" class="">昆德拉筆記</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E6%96%87%E7%AB%A0/%E9%81%93%E5%BE%B7%E7%B6%93%E7%AD%86%E8%A8%98/" class="">道德經筆記</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>作品</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E7%9F%A9%E9%99%A3%E8%A8%88%E7%AE%97%E6%A9%9F_%E8%A1%A8%E6%A0%BC/" class="">矩陣計算機: 表格</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e81122d6361d2ad759472bf978c05617" class="toggle"  />
    <label for="section-e81122d6361d2ad759472bf978c05617" class="flex justify-between">
      <a href="/docs/%E4%BD%9C%E5%93%81/%E6%8D%8F%E6%B3%A5%E5%B7%B4/" class="">捏泥巴</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E6%8D%8F%E6%B3%A5%E5%B7%B4/00/" class="">00. 給世界與你的搖籃曲</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E6%8D%8F%E6%B3%A5%E5%B7%B4/01/" class="">01. 我的意義，在我之外</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E6%8D%8F%E6%B3%A5%E5%B7%B4/02/" class="">02. 行列式與鏡銘石</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E6%8D%8F%E6%B3%A5%E5%B7%B4/03/" class="">03. 論「美」</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E6%8D%8F%E6%B3%A5%E5%B7%B4/04/" class="">04. 成熟的長、寬、高</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E7%9F%A9%E9%99%A3%E8%A8%88%E7%AE%97%E6%A9%9F_%E6%96%87%E5%AD%97/" class="">矩陣計算機2</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E7%A6%B1%E7%A5%9D%E6%A9%9Fcodereview/" class="">禱祝機 Code Review</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/blender%E7%94%9F%E6%88%90voronoi/" class="">Blender生成 Voronoi</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/pytube%E4%B8%8B%E8%BC%89yt%E5%BD%B1%E7%89%87/" class="">Pytube下載 Yt影片</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E4%B8%BB%E7%BE%A9%E5%B0%8F%E7%99%BE%E7%A7%91/" class="">主義小百科</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E5%A5%BD%E5%AD%B8%E7%94%9F%E6%97%A5%E8%A8%98/" class="">好學生日記</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E5%BD%B1%E7%89%87%E8%87%AA%E5%8B%95%E5%A5%97%E6%A1%86/" class="active">影片自動套框</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E7%9D%AB%E6%AF%9B/" class="">睫毛</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E7%A9%BA%E5%B8%B3%E8%99%9F/" class="">空帳號</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/%E4%BD%9C%E5%93%81/%E8%96%9B%E8%A5%BF%E5%BC%97%E6%96%AF%E4%B9%8B%E6%88%80/" class="">薛西弗斯之戀</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="/posts/"  >
        遺文
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>影片自動套框</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents"></nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="影片自動套框功能開發">
  影片自動套框功能開發
  <a class="anchor" href="#%e5%bd%b1%e7%89%87%e8%87%aa%e5%8b%95%e5%a5%97%e6%a1%86%e5%8a%9f%e8%83%bd%e9%96%8b%e7%99%bc">#</a>
</h1>
<pre tabindex="0"><code>import os
import subprocess
import cv2
import numpy as np

# 設定影片和圖片框的資料夾路徑
videos_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;
frames_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;
output_folder = r&#39;C:\Users\shadwn\Desktop\Auto_FRAMED\JP&#39;

# 取得影片和圖片框的清單
for video_file in os.listdir(videos_folder):
    if video_file.endswith(&#39;.mp4&#39;):
        video_name = os.path.splitext(video_file)[0]
        video_path = os.path.join(videos_folder, video_file)
        

        # 取得圖片框的寬度和高度
        for frame_file in os.listdir(frames_folder):
            if frame_file.endswith(&#39;.png&#39;):
                frame_name = os.path.splitext(frame_file)[0]
                frame_path = os.path.join(frames_folder, frame_file)
                video_output = os.path.join(output_folder, f&#39;{video_name}_{frame_name }.mp4&#39;)

                # 讀取圖片
                image = cv2.imread(frame_path , cv2.IMREAD_UNCHANGED)
                # 提取Alpha通道
                alpha_channel = image[:, :, 3]
                # 找到alpha值為0的像素的位置
                indices = np.where(alpha_channel == 0)
                x_values = indices[1]
                y_values = indices[0]
                min_x = np.min(x_values)
                min_y = np.min(y_values)
                max_x = np.max(x_values)
                max_y = np.max(y_values)
                
                # max_x-min_x+多少 frame_width=max_x-min_x+5 會影響邊框
                frame_width=max_x-min_x+5
                if frame_width%2==1:
                    frame_width=frame_width+1
                frame_height=max_y-min_y+5
                if frame_height%2==1:
                    frame_height=frame_height+1
                
                frame_x=min_x-2
                frame_y=min_y-2
                # 使用 ImageMagick 取得圖片框的寬度和高度
                #command = [&#39;magick&#39;, frame_path, &#39;-alpha&#39;, &#39;extract&#39;, &#39;-gravity&#39;, &#39;center&#39;, &#39;-format&#39;, &#39;%wx%h%O&#39;, &#39;info:&#39;]
                #result = subprocess.run(command, capture_output=True, text=True)
                #frame_width, frame_height = result.stdout.strip().split(&#39;x&#39;)

                # 使用 FFmpeg 將影片調整為圖片框的大小
                output_scaled_video = os.path.join(videos_folder, f&#39;{video_name}_scaled.mp4&#39;)
                command = [&#39;ffmpeg&#39;, &#39;-i&#39;, video_path, &#39;-vf&#39;, f&#39;scale={frame_width}:{frame_height},setsar=1:1&#39;, output_scaled_video]
                subprocess.run(command)

                # 使用 FFmpeg 將圖片框套用到影片上
                command = [&#39;ffmpeg&#39;, &#39;-i&#39;, output_scaled_video, &#39;-i&#39;, frame_path, &#39;-filter_complex&#39;, f&#39;[1:v][0:v]overlay={frame_x}:{frame_y}&#39;, video_output]
                subprocess.run(command)

                # 刪除縮放後的影片
                os.remove(output_scaled_video)
</code></pre></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents"></nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












